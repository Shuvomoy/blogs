<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/blogs/libs/katex/katex.min.css"> <link rel=stylesheet  href="/blogs/libs/highlight/github.min.css"> <link rel=stylesheet  href="/blogs/css/franklin.css"> <link rel=stylesheet  href="/blogs/css/tufte.css"> <link rel=stylesheet  href="/blogs/css/latex.css"> <link rel=stylesheet  href="/blogs/css/adjust.css"> <link rel=stylesheet  href="/blogs/css/FranklinTheorems.css"> <link rel=icon  href="/blogs/assets/favicon.png"> <title>Automated SDP relaxation of QCQPs in JuMP+Julia</title> <link rel=icon  href="/blogs/assets/favicon.ico"> <script src="/blogs/libs/lunr/lunr.min.js"></script> <script src="/blogs/libs/lunr/lunr_index.js"></script> <script src="/blogs/libs/lunr/lunrclient.min.js"></script> <div id=layout > <div id=menu > <ul> <li><a href="/blogs/">Blogs</a> <li><a href="/blogs/index.html#tags">Tags</a> <li><a href="https://shuvomoy.github.io/">Website</a> <li><form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder=" " type=text > <input type=submit  value=Search  formaction="/blogs/search/index.html"> </form> </ul> </div> <div id=main > <!-- Content appended here .result-title a { text-decoration: none; } .result-title a:hover { text-decoration: underline; } .result-preview { color: #808080; } .resultCount { color: #808080; } .result-query { font-weight: bold; } #lunrSearchForm { margin-top: 1em; } --> <div class=franklin-content ><h1 id=automated_sdp_relaxation_of_qcqps_in_jumpjulia ><a href="#automated_sdp_relaxation_of_qcqps_in_jumpjulia" class=header-anchor >Automated SDP relaxation of QCQPs in JuMP&#43;Julia</a></h1> <p><strong>Shuvomoy Das Gupta</strong></p> <p><em>August 27, 2022</em></p> <p>In this blog, we discuss how to construct automatic SDP relaxation of a nonconvex QCQP in <code>Julia&#43;JuMP</code> &#40;based on tips from <a href="https://blegat.github.io/">Benoît Legat</a>&#41;.</p> <h2 id=example_qcqp ><a href="#example_qcqp" class=header-anchor >Example QCQP</a></h2> <p>Consider the following QCQP as an example:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>p</mi><mo lspace=0em  rspace=0em >⋆</mo></msup><mo>=</mo><mrow><mo fence=true >(</mo><mtable rowspacing=0.1600em  columnalign="left left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mtext>minimize</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msubsup><mi>c</mi><mn>1</mn><mi mathvariant=normal >⊤</mi></msubsup><mi>x</mi><mo>+</mo><msubsup><mi>c</mi><mn>2</mn><mi mathvariant=normal >⊤</mi></msubsup><mi>y</mi><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><mrow><mi mathvariant=bold >t</mi><mi mathvariant=bold >r</mi></mrow><mo stretchy=false >(</mo><mi>Z</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mtext>subject to</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><msup><mi>y</mi><mi mathvariant=normal >⊤</mi></msup><mo>+</mo><msub><mi>A</mi><mn>1</mn></msub><mrow><mo fence=true >(</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.1600em  columnalign=center  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo fence=true >)</mo></mrow><mo>=</mo><mi>Z</mi><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>x</mi><msup><mi>y</mi><mi mathvariant=normal >⊤</mi></msup><mo>+</mo><msub><mi>A</mi><mn>2</mn></msub><mrow><mo fence=true >(</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.1600em  columnalign=center  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo fence=true >)</mo></mrow><mo>≤</mo><mn>0</mn><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>Z</mi><mo>=</mo><mi>P</mi><msup><mi>P</mi><mi mathvariant=normal >⊤</mi></msup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=true >)</mo></mrow><mspace width=1em /><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p^{\star}=\left(\begin{array}{ll} \textrm{minimize} &amp; c_{1}^{\top}x+c_{2}^{\top}y+c_{3}\mathbf{tr}(Z)\\ \textrm{subject to} &amp; a_{1}xy^{\top}+A_{1}\left(\begin{bmatrix}x\\ y \end{bmatrix}\right)=Z,\\ &amp; xy^{\top}+A_{2}\left(\begin{bmatrix}x\\ y \end{bmatrix}\right)\leq0,\\ &amp; Z=PP^{\top}, \end{array}\right)\quad(1) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.933136em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:7.218276000000001em;vertical-align:-3.359138em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.8500499999999995em;"><span style="top:-2.91103em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-4.05803em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span style="height:3.616059999999999em;width:0.875em;"><svg width='0.875em' height='3.616059999999999em' style='width:0.875em' viewBox='0 0 875 3616' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V3616 H291z M291 0 H417 V3616 H291z'/></svg></span></span><span style="top:-8.31111em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:3.3500499999999995em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.8591380000000006em;"><span style="top:-6.460030000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class="mord text"><span class="mord textrm">minimize</span></span></span></span><span style="top:-4.650030000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class="mord text"><span class="mord textrm">subject to</span></span></span></span><span style="top:-2.2500000000000004em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ></span></span><span style="top:-0.45086200000000004em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:3.359138em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.8591380000000006em;"><span style="top:-6.460030000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">tr</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mclose >)</span></span></span><span style="top:-4.650030000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mpunct >,</span></span></span><span style="top:-2.2500000000000004em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span><span style="top:-0.45086200000000004em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:3.359138em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span><span class=mclose ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.8500499999999995em;"><span style="top:-2.91103em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-4.05803em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span style="height:3.616059999999999em;width:0.875em;"><svg width='0.875em' height='3.616059999999999em' style='width:0.875em' viewBox='0 0 875 3616' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V3616 H457z M457 0 H583 V3616 H457z'/></svg></span></span><span style="top:-8.31111em;"><span class=pstrut  style="height:5.616059999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:3.3500499999999995em;"><span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span></span> <p>where the decision variables are: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo>∈</mo><msup><mi mathvariant=bold >R</mi><mn>2</mn></msup><mo separator=true >,</mo><mtext> </mtext><mi>P</mi><mo separator=true >,</mo><mi>Z</mi><mo>∈</mo><msup><mi mathvariant=bold >S</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x,y\in\mathbf{R}^{2},\; P,Z\in\mathbf{S}^{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathbf">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>.We have the bound information that the optimal value lies between <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mo>−</mo><mn>400</mn><mo separator=true >,</mo><mo>−</mo><mn>200</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[-400,-200]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >−</span><span class=mord >400</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >−</span><span class=mord >200</span><span class=mclose >]</span></span></span></span>Here <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>A</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">A_1, A_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are linear operators from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold >R</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">\mathbf{R}^4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=bold >S</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbf{S}^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. First, let us solve the problem to global optimality using <code>Gurobi&#43;JuMP</code>.</p> <pre><code class="julia hljs"><span class=hljs-comment ># Load the packages</span>
<span class=hljs-keyword >using</span> JuMP, Gurobi, MosekTools, Mosek, LinearAlgebra, DiffOpt</code></pre> <pre><code class="julia hljs"><span class=hljs-comment ># Problem data:</span>
c_1 = [-<span class=hljs-number >3</span>; -<span class=hljs-number >5</span>]
c_2 = [<span class=hljs-number >2</span>; -<span class=hljs-number >5</span>]
c_3 = -<span class=hljs-number >1</span>
a_1 = <span class=hljs-number >4</span>
A_1_op(x,y) = [<span class=hljs-number >3</span>*x[<span class=hljs-number >1</span>]+<span class=hljs-number >2</span>*y[<span class=hljs-number >2</span>] -x[<span class=hljs-number >2</span>]+y[<span class=hljs-number >1</span>]; -x[<span class=hljs-number >2</span>]+y[<span class=hljs-number >1</span>] -<span class=hljs-number >4</span>*x[<span class=hljs-number >2</span>]+y[<span class=hljs-number >2</span>]]
A_2_op(x,y) = [<span class=hljs-number >2</span>*x[<span class=hljs-number >1</span>]-<span class=hljs-number >5</span>*y[<span class=hljs-number >2</span>] -<span class=hljs-number >3</span>*x[<span class=hljs-number >2</span>]+<span class=hljs-number >2</span>*y[<span class=hljs-number >1</span>]; -<span class=hljs-number >3</span>*x[<span class=hljs-number >2</span>]+<span class=hljs-number >2</span>*y[<span class=hljs-number >1</span>] <span class=hljs-number >4</span>*x[<span class=hljs-number >2</span>]-<span class=hljs-number >7</span>*y[<span class=hljs-number >2</span>]]
x_lb = <span class=hljs-number >0</span>
x_ub = <span class=hljs-number >5</span>
y_lb = <span class=hljs-number >0</span>
y_ub = <span class=hljs-number >10</span></code></pre> <h2 id=solving_the_qcqp_to_global_optimality ><a href="#solving_the_qcqp_to_global_optimality" class=header-anchor >Solving the QCQP to global optimality</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> QCQP_solver(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub)

    nonlinear_model = Model(Gurobi.Optimizer)

    set_optimizer_attribute(nonlinear_model, <span class=hljs-string >&quot;NonConvex&quot;</span>, <span class=hljs-number >2</span>)

    <span class=hljs-meta >@variable</span>(nonlinear_model, x_lb &lt;= x[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= x_ub)

    <span class=hljs-meta >@variable</span>(nonlinear_model, y_lb &lt;= y[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= y_ub)

    <span class=hljs-meta >@variable</span>(nonlinear_model, Z[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>, <span class=hljs-number >1</span>:<span class=hljs-number >2</span>], Symmetric)

    <span class=hljs-meta >@variable</span>(nonlinear_model, P[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>, <span class=hljs-number >1</span>:<span class=hljs-number >2</span>])

    <span class=hljs-meta >@objective</span>( nonlinear_model, Min, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) )

    con_shape = SymmetricMatrixShape(<span class=hljs-number >2</span>)

    QuadCon1 = <span class=hljs-meta >@constraint</span>(nonlinear_model, vectorize(a_1*x*transpose(y) + A_1_op(x,y) - Z, con_shape) .== <span class=hljs-number >0</span> )

    QuadCon2 = <span class=hljs-meta >@constraint</span>(nonlinear_model, vectorize(x*transpose(y) + A_2_op(x,y), con_shape) .&lt;= <span class=hljs-number >0</span> )

    SDPCon3 = <span class=hljs-meta >@constraint</span>(nonlinear_model, vectorize(Z - P*P&#x27;, con_shape) .== <span class=hljs-number >0</span> )

    <span class=hljs-meta >@constraint</span>(nonlinear_model, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) &gt;= -<span class=hljs-number >400</span> )

    <span class=hljs-meta >@constraint</span>(nonlinear_model, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) &lt;= -<span class=hljs-number >200</span> )

    optimize!(nonlinear_model)

    p_star = objective_value(nonlinear_model)

    x_star = value.(x)

    y_star = value.(y)

    Z_star = value.(Z)

    <span class=hljs-meta >@show</span> x_star

    <span class=hljs-meta >@show</span> y_star

    <span class=hljs-meta >@show</span> Z_star

    <span class=hljs-meta >@show</span> p_star

    <span class=hljs-keyword >return</span> x_star, y_star, Z_star, p_star

<span class=hljs-keyword >end</span></code></pre> <p>Let us run the function.</p> <pre><code class="julia hljs">x_star, y_star, Z_star, p_star = QCQP_solver(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub)</code></pre>
<h2 id=extracting_the_data_to_construct_sdp_relaxation ><a href="#extracting_the_data_to_construct_sdp_relaxation" class=header-anchor >Extracting the data to construct SDP relaxation</a></h2>
<p>We have three quadratic constraint arrays in &#40;1&#41;. The third one is just <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>⪰</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Z\succeq0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⪰</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>, so we can just model that. For the first and second, we want to convert them into standard form quadratic constraints.</p>
<p>Defining <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mtext>vec</mtext><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">w=\textrm{vec}(x,y)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord textrm">vec</span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span></span> we want to write the first quadratic constraint</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><msup><mi>y</mi><mi mathvariant=normal >⊤</mi></msup><mo>+</mo><msub><mi>A</mi><mn>1</mn></msub><mrow><mo fence=true >(</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.1600em  columnalign=center  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo fence=true >)</mo></mrow><mo>=</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">
a_{1}xy^{\top}+A_{1}\left(\begin{bmatrix}x\\
y
\end{bmatrix}\right)=Z
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.093548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span>
<p>as</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup><msubsup><mi>P</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo><mi mathvariant=normal >⊤</mi></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>r</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo>=</mo><msub><mi>Z</mi><mrow><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi></mrow></msub><mspace width=1em /><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext>  </mtext><mi mathvariant=normal >ℓ</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mi>k</mi><mo stretchy=false >]</mo><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">
w^{\top}P_{1}^{(k,\ell)}w+q_{1}^{(k,\ell)\top}w+r_{1}^{(k,\ell)}=Z_{k,\ell}\quad k\in[1:2],\;\ell\in[1:k],
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span></span>
<p>and we want to write the second quadratic constraint</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>x</mi><msup><mi>y</mi><mi mathvariant=normal >⊤</mi></msup><mo>+</mo><msub><mi>A</mi><mn>2</mn></msub><mrow><mo fence=true >(</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.1600em  columnalign=center  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo fence=true >)</mo></mrow><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
xy^{\top}+A_{2}\left(\begin{bmatrix}x\\
y
\end{bmatrix}\right) \leq 0
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.093548em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span>
<p>as</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup><msubsup><mi>P</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo><mi mathvariant=normal >⊤</mi></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>r</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo>≤</mo><mn>0</mn><mo separator=true >,</mo><mspace width=1em /><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext>  </mtext><mi mathvariant=normal >ℓ</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mi>k</mi><mo stretchy=false >]</mo><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">
w^{\top}P_{2}^{(k,\ell)}w+q_{2}^{(k,\ell)\top}w+r_{2}^{(k,\ell)} \leq 0, \quad k\in[1:2],\;\ell\in[1:k],
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.311108em;vertical-align:-0.266308em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo separator=true >,</mo><msubsup><mi>q</mi><mi>i</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo separator=true >,</mo><msubsup><mi>r</mi><mi>i</mi><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">P_{i}^{(k,\ell)},q_{i}^{(k,\ell)},r_{i}^{(k,\ell)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span></span> are problemdata that we are going to extract from the original problem.</p>
<p>Let us create a <code>struct</code> that will help in providing the quadratic form data <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo separator=true >,</mo><mi>q</mi><mo separator=true >,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">P,q,r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> DiffOpt

<span class=hljs-keyword >struct</span> Form
    P
    q
    r
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >using</span> LinearAlgebra

LinearAlgebra.symmetric_type(::<span class=hljs-built_in >Type</span>{Form}) = Form
LinearAlgebra.symmetric(f::Form, ::<span class=hljs-built_in >Symbol</span>) = f
LinearAlgebra.transpose(f::Form) = f</code></pre>
<p>The following function creates the data to construct the SDP relaxation.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> standard_form_data_constructor(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub)

    data_model = Model()

    <span class=hljs-meta >@variable</span>(data_model, x_lb &lt;= x[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= x_ub)

    <span class=hljs-meta >@variable</span>(data_model, y_lb &lt;= y[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= y_ub)

    <span class=hljs-meta >@variable</span>(data_model, Z[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>, <span class=hljs-number >1</span>:<span class=hljs-number >2</span>], Symmetric)

    w = <span class=hljs-built_in >Vector</span>{VariableRef}[]

    push!(w, x)

    push!(w, y)

    <span class=hljs-comment ># create the vectorized w</span>

    w_vec = reduce(vcat, w)

    <span class=hljs-comment ># Add the qcqp constraints that we want to take to standard form</span>

    con_shape = SymmetricMatrixShape(<span class=hljs-number >2</span>)

    QuadCon1 = <span class=hljs-meta >@constraint</span>(data_model, vectorize(a_1*x*transpose(y) + A_1_op(x,y) - Z, con_shape) .== <span class=hljs-number >0</span> )

    QuadCon2 = <span class=hljs-meta >@constraint</span>(data_model, vectorize(x*transpose(y) + A_2_op(x,y), con_shape) .&lt;= <span class=hljs-number >0</span> )

    <span class=hljs-comment ># create index map that will contain the indices of the original decision variables</span>

    index_map = MOI.Utilities.IndexMap()

    <span class=hljs-keyword >for</span> (i, var_ref) <span class=hljs-keyword >in</span> enumerate(w_vec)
        index_map[JuMP.index(var_ref)] = MOI.VariableIndex(i)
    <span class=hljs-keyword >end</span>

    n = length(index_map.var_map)

    remove = JuMP.index.(JuMP.vectorize(Z, con_shape)) <span class=hljs-comment ># we have to ensure that we are not considering Z in w</span>

    <span class=hljs-comment ># The function `standard_form(con_ref::JuMP.ConstraintRef)` will take a `JuMP` quadratic function and convert it into a standard form quadratic constraint of the form $w^\top P w + q^\top w + r$ form.</span>
    <span class=hljs-keyword >function</span> standard_form_data(con_ref::JuMP.ConstraintRef)
        object = JuMP.constraint_object(con_ref)
        quad_func = JuMP.moi_function(object)
        quad_func = MOI.Utilities.substitute_variables(quad_func) <span class=hljs-keyword >do</span> var
            F = MOI.ScalarAffineFunction{<span class=hljs-built_in >Float64</span>}
            <span class=hljs-keyword >if</span> var <span class=hljs-keyword >in</span> remove
                <span class=hljs-keyword >return</span> zero(F)
            <span class=hljs-keyword >else</span>
                <span class=hljs-keyword >return</span> convert(F, var)
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
        matrix = DiffOpt.sparse_array_representation(quad_func, n, index_map)
        r = matrix.constant - MOI.constant(JuMP.moi_set(object))
        P, q = <span class=hljs-built_in >Matrix</span>(<span class=hljs-number >0.5</span>*matrix.quadratic_terms), <span class=hljs-built_in >Vector</span>(matrix.affine_terms)
        <span class=hljs-comment ># P, q = 0.5*matrix.quadratic_terms, matrix.affine_terms</span>
        <span class=hljs-keyword >return</span> Form(P, q, r)
    <span class=hljs-keyword >end</span>

    QuadCon1StdTerms = JuMP.reshape_vector(standard_form_data.(QuadCon1), con_shape)
    <span class=hljs-comment ># For example,</span>
    <span class=hljs-comment ># QuadCon1StdTerms[1,1].P will give us corresponding P</span>
    <span class=hljs-comment ># QuadCon1StdTerms[1,1].q will give us corresponding q</span>
    <span class=hljs-comment ># QuadCon1StdTerms[1,1].r will give us corresponding r</span>

    <span class=hljs-comment ># QuadCon2StdTerms = map(QuadCon2) do con_refs</span>
    <span class=hljs-comment >#     JuMP.reshape_vector(standard_form_data.(QuadCon2), con_shape)</span>
    <span class=hljs-comment ># end</span>

    QuadCon2StdTerms = JuMP.reshape_vector(standard_form_data.(QuadCon2), con_shape)

    <span class=hljs-keyword >return</span> QuadCon1StdTerms, QuadCon2StdTerms

<span class=hljs-keyword >end</span></code></pre>
<p>Test the function.</p>
<pre><code class="julia hljs">QuadCon1StdTerms, QuadCon2StdTerms = standard_form_data_constructor(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub)

<span class=hljs-comment ># For example,</span>
<span class=hljs-comment ># QuadCon1StdTerms[1,1].P will give us corresponding P</span>
<span class=hljs-comment ># QuadCon1StdTerms[1,1].q will give us corresponding q</span>
<span class=hljs-comment ># QuadCon1StdTerms[1,1].r will give us corresponding r</span></code></pre>
<h2 id=sdp_relaxation_model ><a href="#sdp_relaxation_model" class=header-anchor >SDP relaxation model</a></h2>
<p>So, we have the following SDP relaxation of &#40;2&#41;:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mi>p</mi><mtext>SDP</mtext><mo lspace=0em  rspace=0em >⋆</mo></msubsup><mo>=</mo><mrow><mo fence=true >(</mo><mtable rowspacing=0.1600em  columnalign="left left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mtext>minimize</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msubsup><mi>c</mi><mn>1</mn><mi mathvariant=normal >⊤</mi></msubsup><mi>x</mi><mo>+</mo><msubsup><mi>c</mi><mn>2</mn><mi mathvariant=normal >⊤</mi></msubsup><mi>y</mi><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><mrow><mi mathvariant=bold >t</mi><mi mathvariant=bold >r</mi></mrow><mo stretchy=false >(</mo><mi>Z</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mtext>subject to</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=bold >t</mi><mi mathvariant=bold >r</mi></mrow><mo stretchy=false >(</mo><msubsup><mi>P</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mi>W</mi><mo stretchy=false >)</mo><mo>+</mo><msubsup><mi>q</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo><mi mathvariant=normal >⊤</mi></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>r</mi><mn>1</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo>=</mo><msub><mi>Z</mi><mrow><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi></mrow></msub><mo separator=true >,</mo><mspace width=1em /><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext>  </mtext><mi mathvariant=normal >ℓ</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mi>k</mi><mo stretchy=false >]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=bold >t</mi><mi mathvariant=bold >r</mi></mrow><mo stretchy=false >(</mo><msubsup><mi>P</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mi>W</mi><mo stretchy=false >)</mo><mo>+</mo><msubsup><mi>q</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo><mi mathvariant=normal >⊤</mi></mrow></msubsup><mi>w</mi><mo>+</mo><msubsup><mi>r</mi><mn>2</mn><mrow><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi mathvariant=normal >ℓ</mi><mo stretchy=false >)</mo></mrow></msubsup><mo>≤</mo><mn>0</mn><mo separator=true >,</mo><mspace width=1em /><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mn>2</mn><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext>  </mtext><mi mathvariant=normal >ℓ</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>1</mn><mo>:</mo><mi>k</mi><mo stretchy=false >]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>Z</mi><mo>⪰</mo><mn>0</mn><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mo fence=true >[</mo><mtable rowspacing=0.1600em  columnalign="center center" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>W</mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>w</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>⪰</mo><mn>0</mn><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>w</mi><mo>=</mo><mtext>vec</mtext><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>W</mi><mo>−</mo><msub><mi>l</mi><mi>w</mi></msub><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup><mo>−</mo><mi>w</mi><msubsup><mi>l</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo>≥</mo><mo>−</mo><msub><mi>l</mi><mi>w</mi></msub><msubsup><mi>l</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>W</mi><mo>−</mo><msub><mi>l</mi><mi>w</mi></msub><mi>w</mi><msup><mrow></mrow><mi mathvariant=normal >⊤</mi></msup><mo>−</mo><mi>w</mi><msubsup><mi>l</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo>≥</mo><mo>−</mo><msub><mi>u</mi><mi>w</mi></msub><msubsup><mi>u</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>W</mi><mo>−</mo><msub><mi>l</mi><mi>w</mi></msub><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup><mo>−</mo><mi>w</mi><msubsup><mi>u</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo>≥</mo><mo>−</mo><msub><mi>l</mi><mi>w</mi></msub><msubsup><mi>u</mi><mi>w</mi><mi mathvariant=normal >⊤</mi></msubsup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi>l</mi><mi>w</mi></msub><mo>≤</mo><mi>w</mi><mo>≤</mo><msub><mi>u</mi><mi>w</mi></msub><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex">
p_{\textrm{SDP}}^{\star}=\left(\begin{array}{ll}
\textrm{minimize} &amp; c_{1}^{\top}x+c_{2}^{\top}y+c_{3}\mathbf{tr}(Z)\\
\textrm{subject to} &amp; \mathbf{tr}(P_{1}^{(k,\ell)}W)+q_{1}^{(k,\ell)\top}w+r_{1}^{(k,\ell)}=Z_{k,\ell},\quad k\in[1:2],\;\ell\in[1:k],\\
 &amp; \mathbf{tr}(P_{2}^{(k,\ell)}W)+q_{2}^{(k,\ell)\top}w+r_{2}^{(k,\ell)}\leq0,\quad k\in[1:2],\;\ell\in[1:k],\\
 &amp; Z\succeq0,\\
 &amp; \begin{bmatrix}W &amp; w\\
w^{\top} &amp; 1
\end{bmatrix}\succeq0,\\
 &amp; w=\textrm{vec}(x,y),\\
 &amp; W-l_{w}w^{\top}-wl_{w}^{\top}\geq-l_{w}l_{w}^{\top},\\
 &amp; W-l_{w}w{}^{\top}-wl_{w}^{\top}\geq-u_{w}u_{w}^{\top},\\
 &amp; W-l_{w}w^{\top}-wu_{w}^{\top}\geq-l_{w}u_{w}^{\top},\\
 &amp; l_{w}\leq w\leq u_{w},
\end{array}\right)
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.9856959999999999em;vertical-align:-0.247em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7386959999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textrm mtight">SDP</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⋆</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:13.655139999999996em;vertical-align:-6.577569999999997em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.850099999999999em;"><span style="top:-5.911079999999999em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-7.0580799999999995em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span style="height:9.616159999999999em;width:0.875em;"><svg width='0.875em' height='9.616159999999999em' style='width:0.875em' viewBox='0 0 875 9616' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V9616 H291z M291 0 H417 V9616 H291z'/></svg></span></span><span style="top:-17.311259999999997em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:6.350099999999999em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:7.077569999999998em;"><span style="top:-9.683015999999997em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord text"><span class="mord textrm">minimize</span></span></span></span><span style="top:-8.278215999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord text"><span class="mord textrm">subject to</span></span></span></span><span style="top:-6.873415999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:-5.673415999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:-3.8588619999999985em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:-2.0643079999999974em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:-0.8551999999999988em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:0.35390799999999994em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:1.5630159999999986em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span><span style="top:2.7630159999999973em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:6.577569999999997em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:7.077569999999998em;"><span style="top:-9.683015999999997em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">tr</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mclose >)</span></span></span><span style="top:-8.278215999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">tr</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >2</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mpunct >,</span></span></span><span style="top:-6.873415999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">tr</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mtight">ℓ</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >2</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >ℓ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mpunct >,</span></span></span><span style="top:-5.673415999999999em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⪰</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span><span style="top:-3.8588619999999985em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4545540000000001em;"><span style="top:-3.614554em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-2.405445999999999em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9545540000000006em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4545540000000001em;"><span style="top:-3.614554em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-2.405445999999999em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9545540000000006em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⪰</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span><span style="top:-2.0643079999999974em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord text"><span class="mord textrm">vec</span></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mpunct >,</span></span></span><span style="top:-0.8551999999999988em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span><span style="top:0.35390799999999994em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mord ><span class=mord ></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span><span style="top:1.5630159999999986em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊤</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span><span style="top:2.7630159999999973em;"><span class=pstrut  style="height:3.454554em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:6.577569999999997em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span><span class=mclose ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.850099999999999em;"><span style="top:-5.911079999999999em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-7.0580799999999995em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span style="height:9.616159999999999em;width:0.875em;"><svg width='0.875em' height='9.616159999999999em' style='width:0.875em' viewBox='0 0 875 9616' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V9616 H457z M457 0 H583 V9616 H457z'/></svg></span></span><span style="top:-17.311259999999997em;"><span class=pstrut  style="height:11.616159999999999em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:6.350099999999999em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>where the decision variables are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo>∈</mo><msup><mi mathvariant=bold >R</mi><mn>2</mn></msup><mo separator=true >,</mo><mtext>  </mtext><mi>Z</mi><mo>∈</mo><msup><mi mathvariant=bold >S</mi><mn>2</mn></msup><mo separator=true >,</mo><mtext>  </mtext><mi>W</mi><mo>∈</mo><msup><mi mathvariant=bold >S</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">x,y\in\mathbf{R}^{2},\; Z\in\mathbf{S}^{2},\; W\in\mathbf{S}^{4}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathbf">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathbf">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>. The last four constraints are called RLT cuts that are valid inequalities for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mi>w</mi><msup><mi>w</mi><mi mathvariant=normal >⊤</mi></msup></mrow><annotation encoding="application/x-tex">W=w w^\top</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.849108em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span></span></span></span>. For more details about the RLT cut and how the SDP relaxation is constructed in general, see</p>
<blockquote>
<p>Anstreicher, Kurt M. &quot;Semidefinite programming versus the reformulation-linearization technique for nonconvex quadratically constrained quadratic programming.&quot; <em>Journal of Global Optimization</em> 43.2 &#40;2009&#41;: 471-484.   </p>
<p>&#40;Link: <a href="http://www.optimization-online.org/DB_FILE/2007/05/1655.pdf">http://www.optimization-online.org/DB_FILE/2007/05/1655.pdf</a>&#41;</p>
</blockquote>
<p>Let us solve the SDP model step by step.</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Mosek, MosekTools

<span class=hljs-keyword >function</span> SDP_relaxation_solver(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub, QuadCon1StdTerms, QuadCon2StdTerms; big_M = <span class=hljs-number >100</span>, RLT_cut = :on)

    <span class=hljs-comment ># Define the SDP model</span>

    SDP_model = Model(optimizer_with_attributes(Mosek.Optimizer))

    <span class=hljs-meta >@variable</span>(SDP_model, x_lb &lt;= x[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= x_ub)

    <span class=hljs-meta >@variable</span>(SDP_model, y_lb &lt;= y[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] &lt;= y_ub)

    <span class=hljs-meta >@variable</span>(SDP_model, Z[<span class=hljs-number >1</span>:<span class=hljs-number >2</span>, <span class=hljs-number >1</span>:<span class=hljs-number >2</span>], PSD)

    w = <span class=hljs-built_in >Vector</span>{VariableRef}[]

    push!(w, x)

    push!(w, y)

    <span class=hljs-comment ># create the vectorized w</span>

    w_vec = reduce(vcat, w)

    len_w = length(w_vec)


    <span class=hljs-meta >@variable</span>(SDP_model, W[<span class=hljs-number >1</span>:len_w, <span class=hljs-number >1</span>:len_w], Symmetric)

    <span class=hljs-meta >@objective</span>(SDP_model, Min, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) )

    dim_Z = <span class=hljs-number >2</span>

    <span class=hljs-comment ># SDP relaxation of qudratic constraint 1</span>
    <span class=hljs-comment ># ---------------------------------------</span>

    <span class=hljs-keyword >for</span> k <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:dim_Z
        <span class=hljs-keyword >for</span> ℓ <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:k
            <span class=hljs-meta >@constraint</span>(SDP_model, tr(QuadCon1StdTerms[k,ℓ].P * W) + (QuadCon1StdTerms[k,ℓ].q)&#x27;*w_vec + (QuadCon1StdTerms[k,ℓ].r) == Z[k,ℓ] )
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>

    <span class=hljs-comment ># SDP relaxation of qudratic constraint 2</span>
    <span class=hljs-comment ># ---------------------------------------</span>

    <span class=hljs-keyword >for</span> k <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:dim_Z
        <span class=hljs-keyword >for</span> ℓ <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:k
            <span class=hljs-meta >@constraint</span>(SDP_model, tr(QuadCon2StdTerms[k,ℓ].P * W) + (QuadCon2StdTerms[k,ℓ].q)&#x27;*w_vec + (QuadCon2StdTerms[k,ℓ].r) &lt;= <span class=hljs-number >0</span> )
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>

    <span class=hljs-comment ># Schur complement constraint</span>
    <span class=hljs-comment ># ---------------------------</span>

    <span class=hljs-meta >@constraint</span>(SDP_model, schurCon, [W w_vec; w_vec&#x27; <span class=hljs-number >1</span>] <span class=hljs-keyword >in</span> PSDCone())

    <span class=hljs-meta >@constraint</span>(SDP_model, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) &gt;= -<span class=hljs-number >400</span> )

    <span class=hljs-meta >@constraint</span>(SDP_model, c_1&#x27;*x + c_2&#x27;*y + c_3*tr(Z) &lt;= -<span class=hljs-number >200</span> )

    <span class=hljs-comment ># Add RLT cuts</span>
    <span class=hljs-comment ># ------------</span>

    <span class=hljs-keyword >if</span> RLT_cut == :on

        <span class=hljs-comment ># construct lower and upper bound vector for w_vec</span>

        l_w = zeros(len_w)
        u_w = zeros(len_w)

        <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:len_w

            <span class=hljs-keyword >if</span> has_upper_bound(w_vec[i]) == <span class=hljs-literal >true</span>
                u_w[i] = upper_bound(w_vec[i])
            <span class=hljs-keyword >else</span>
                u_w[i] = big_M
            <span class=hljs-keyword >end</span>

            <span class=hljs-keyword >if</span> has_lower_bound(w_vec[i]) == <span class=hljs-literal >true</span>
                l_w[i] = lower_bound(w_vec[i])
            <span class=hljs-keyword >else</span>
                l_w[i] = -big_M
            <span class=hljs-keyword >end</span>

        <span class=hljs-keyword >end</span>

        <span class=hljs-comment ># Add RLT cuts</span>
        <span class=hljs-comment ># ------------</span>

        con_shape = SymmetricMatrixShape(<span class=hljs-number >2</span>)

        <span class=hljs-meta >@info</span> <span class=hljs-string >&quot;[🎠 ] Adding RLT cuts&quot;</span>

        <span class=hljs-meta >@constraint</span>(SDP_model, RLT_cut_1, vectorize( W - l_w*w_vec&#x27; - w_vec*l_w&#x27; + l_w*l_w&#x27;, con_shape) .&gt;= <span class=hljs-number >0</span>)

        <span class=hljs-meta >@constraint</span>(SDP_model, RLT_cut_2, vectorize(W - l_w*w_vec&#x27; - w_vec*l_w&#x27; + u_w*u_w&#x27;, con_shape) .&gt;= <span class=hljs-number >0</span>)

        <span class=hljs-meta >@constraint</span>(SDP_model, RLT_cut_3, vectorize(W - l_w*w_vec&#x27; - w_vec*u_w&#x27; + l_w*u_w&#x27;, con_shape) .&gt;= <span class=hljs-number >0</span>)

        <span class=hljs-meta >@constraint</span>(SDP_model, RLT_cut_4, l_w .&lt;= w_vec)

        <span class=hljs-meta >@constraint</span>(SDP_model, RLT_cut_5, w_vec .&lt;= u_w )

    <span class=hljs-keyword >end</span>

    <span class=hljs-comment ># Solve the optimization problem</span>

    optimize!(SDP_model)

    objective_value(SDP_model)

    <span class=hljs-keyword >if</span> termination_status(SDP_model) != MOI.OPTIMAL
        <span class=hljs-meta >@info</span> <span class=hljs-string >&quot;[💀]&quot;</span>
        <span class=hljs-meta >@error</span> <span class=hljs-string >&quot;model_dual_PEP_with_known_stepsizes solving did not reach optimality;  termination status = &quot;</span> termination_status(SDP_model)
    <span class=hljs-keyword >end</span>

    x_star = value.(x)

    y_star = value.(y)

    Z_star = value.(Z)

    W_star = value.(W)

    p_star = objective_value(SDP_model)

    <span class=hljs-keyword >return</span> x_star, y_star, Z_star, W_star, p_star

<span class=hljs-keyword >end</span></code></pre>
<p>Test the function.</p>
<pre><code class="julia hljs">x_star_SDP, y_star_SDP, Z_star_SDP, W_star_SDP, p_star_SDP = SDP_relaxation_solver(c_1, c_2, c_3, a_1, x_lb, x_ub, y_lb, y_ub, QuadCon1StdTerms, QuadCon2StdTerms; big_M = <span class=hljs-number >100</span>, RLT_cut = :on)</code></pre>
<div class=page-foot >
  <div class=copyright >
    &copy; Shuvomoy Das Gupta. Last modified: June 12, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
        </div> 
    </div>