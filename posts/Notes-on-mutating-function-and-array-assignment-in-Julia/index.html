<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/blogs/libs/highlight/github.min.css"> <link rel=stylesheet  href="/blogs/css/franklin.css"> <link rel=stylesheet  href="/blogs/css/tufte.css"> <link rel=stylesheet  href="/blogs/css/latex.css"> <link rel=stylesheet  href="/blogs/css/adjust.css"> <link rel=icon  href="/blogs/assets/favicon.ico"> <title>Mutating function and array assignment in Julia</title> <script src="/blogs/libs/lunr/lunr.min.js"></script> <script src="/blogs/libs/lunr/lunr_index.js"></script> <script src="/blogs/libs/lunr/lunrclient.min.js"></script> <div id=layout > <div id=menu > <ul> <li><a href="/blogs/">Home</a> <li><a href="/blogs/tags/">Tags</a> <li><form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder=" " type=text > <input type=submit  value=Search  formaction="/blogs/search/index.html"> </form> </ul> </div> <div id=main > <!-- Content appended here .result-title a { text-decoration: none; } .result-title a:hover { text-decoration: underline; } .result-preview { color: #808080; } .resultCount { color: #808080; } .result-query { font-weight: bold; } #lunrSearchForm { margin-top: 1em; } --> <div class=franklin-content ><h1 id=mutating_function_and_array_assignment_in_julia ><a href="#mutating_function_and_array_assignment_in_julia" class=header-anchor >Mutating function and array assignment in Julia</a></h1> <p><strong>Shuvomoy Das Gupta</strong></p> <p><em>January 18, 2021</em></p> <p>A mutating function in Julia changes one of its inputs. A common convention is to use <code>&#33;</code> after the name of the function if it is a mutating function. </p> <p>If we are mutating an array type object, for proper mutation we must change what the array contains, <em>not what the array points to</em>.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> frst_inpt_dbl_of_2nd_inpt!(A::<span class=hljs-built_in >AbstractMatrix</span>{&lt;: <span class=hljs-built_in >Real</span>}, B::<span class=hljs-built_in >AbstractMatrix</span>{&lt;: <span class=hljs-built_in >Real</span>})
    A .= <span class=hljs-number >2</span>*B <span class=hljs-comment ># this .= notation ensures that we are changing the content of A</span>
    <span class=hljs-comment ># ðŸ’€ if we do A = B, then it will only change the reference to the array A</span>
<span class=hljs-keyword >end</span></code></pre> <p>Let us test the function above.</p> <pre><code class="julia hljs">B = ones(<span class=hljs-number >5</span>,<span class=hljs-number >5</span>)
A = similar(A)
frst_inpt_dbl_of_2nd_inpt!(A, B)
A</code></pre> <p>which indeed gives us the output:</p> <pre><code class="julia hljs">A =
 <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>
 <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>
 <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>
 <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>
 <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span>  <span class=hljs-number >2.0</span></code></pre> <p>So the contents of <code>A</code> has indeed changed.</p> <p>Just to experiment, let us experiment with a <em>wrong</em> implementation below.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> wrong_frst_inpt_dbl_of_2nd_inpt_ðŸ’€!(A::<span class=hljs-built_in >AbstractMatrix</span>{&lt;: <span class=hljs-built_in >Real</span>}, B::<span class=hljs-built_in >AbstractMatrix</span>{&lt;: <span class=hljs-built_in >Real</span>})
    A = <span class=hljs-number >2</span>*B <span class=hljs-comment ># this will change the references to A, not the values</span>
<span class=hljs-keyword >end</span></code></pre> <pre><code class="julia hljs">B = ones(<span class=hljs-number >5</span>,<span class=hljs-number >5</span>)
A = similar(A)
wrong_frst_inpt_dbl_of_2nd_inpt_ðŸ’€!(A, B)
println(A)</code></pre> <p>which gives us the disastrous output:</p> <pre><code class="julia hljs">A =
<span class=hljs-number >3.5e-323</span>  <span class=hljs-number >8.4e-323</span>   <span class=hljs-number >1.43e-322</span>  <span class=hljs-number >2.17e-322</span>  <span class=hljs-number >2.8e-322</span>
<span class=hljs-number >4.0e-323</span>  <span class=hljs-number >9.4e-323</span>   <span class=hljs-number >1.73e-322</span>  <span class=hljs-number >2.4e-322</span>   <span class=hljs-number >2.87e-322</span>
<span class=hljs-number >4.4e-323</span>  <span class=hljs-number >1.1e-322</span>   <span class=hljs-number >1.9e-322</span>   <span class=hljs-number >2.5e-322</span>   <span class=hljs-number >3.1e-322</span>
<span class=hljs-number >7.0e-323</span>  <span class=hljs-number >1.14e-322</span>  <span class=hljs-number >2.03e-322</span>  <span class=hljs-number >2.57e-322</span>  <span class=hljs-number >3.16e-322</span>
<span class=hljs-number >8.0e-323</span>  <span class=hljs-number >1.33e-322</span>  <span class=hljs-number >2.08e-322</span>  <span class=hljs-number >2.67e-322</span>  <span class=hljs-number >3.2e-322</span></code></pre> <p>For a more detailed explanation of why this happens, see the blog by John White <a href="http://www.johnmyleswhite.com/notebook/2014/09/06/values-vs-bindings-the-map-is-not-the-territory/">here</a>.</p> <div class=page-foot > <div class=copyright > &copy; Shuvomoy Das Gupta. Last modified: June 09, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div>